{{ define "main" }}
    {{ $pages := where .Data.Pages ".Params.unlisted" "!=" true }}
    {{ $paginator := .Paginate $pages }}
    
    <main class="posts">
        <h1>{{ .Title }}</h1>
        {{ if .Content }}
            <div class="content">{{ .Content }}</div>
        {{ end }}
        <div class="categories">
            <!-- <h3>Tags</h3> -->
            {{range ($.Site.GetPage "taxonomyTerm" "categories").Pages }}
                <a href="{{.Permalink}}">
                    <span class="categories-button" >{{.Title}}</a></span>
                </a>
            {{end}}
        </div>
        {{ range $paginator.Pages.GroupByDate "2006" }}

            <div class="posts-group">
                <div class="post-year">{{ .Key }}</div>

                <ul class="posts-list">
                    {{ range .Pages }}
                        <li class="post-item">
                            <a href="{{.Permalink}}" class="post-item-inner">
                                <span class="post-title">{{.Title}}</span>
                                <span class="post-day">
                                    {{ if .Site.Params.dateformShort }}
                                        {{ .Date.Format .Site.Params.dateformShort }}
                                    {{ else }}
                                        {{ .Date.Format "Jan 2"}}
                                    {{ end }}
                                </span>
                            </a>
                        </li>
                    {{ end }}
                </ul>
            </div>
        {{ end }}
    {{ partial "pagination-list.html" . }}
    
    <!-- RSS Feeds Footer -->
    <div class="rss-feeds-footer">
        <div class="rss-trigger" id="rss-trigger" aria-label="Subscribe to RSS feeds" tabindex="0">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M4 11a9 9 0 0 1 9 9"></path>
                <path d="M4 4a16 16 0 0 1 16 16"></path>
                <circle cx="5" cy="19" r="1"></circle>
            </svg>
            <span>RSS Feeds</span>
        </div>
        <div class="rss-dropdown" id="rss-dropdown">
            <div class="rss-dropdown-header">Subscribe to RSS Feeds</div>
            <ul class="rss-list">
                <li><a href="{{ "blog/index.xml" | relURL }}" aria-label="All Blog Posts RSS Feed"><span class="rss-icon">üìù</span> All Blog Posts</a></li>
                {{ range ($.Site.GetPage "taxonomyTerm" "categories").Pages }}
                <li><a href="{{ .Permalink }}index.xml" aria-label="{{ .Title }} RSS Feed"><span class="rss-icon">üìÅ</span> {{ .Title }}</a></li>
                {{ end }}
            </ul>
            <div class="rss-dropdown-footer">
                <small>Click any feed to subscribe in your RSS reader</small>
            </div>
        </div>
    </div>
    
    <script>
        (function() {
            const trigger = document.getElementById('rss-trigger');
            const dropdown = document.getElementById('rss-dropdown');
            
            if (trigger && dropdown) {
                trigger.addEventListener('click', function(e) {
                    e.stopPropagation();
                    dropdown.classList.toggle('show');
                });
                
                trigger.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        dropdown.classList.toggle('show');
                    }
                });
                
                document.addEventListener('click', function(e) {
                    if (!dropdown.contains(e.target) && e.target !== trigger) {
                        dropdown.classList.remove('show');
                    }
                });
            }
        })();
    </script>
    </main>
{{ end }}

